<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=5.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0F172A">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ | K2PS Marketplace</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --navy: #0F172A; --navy-2: #1E293B; --navy-3: #334155;
            --slate: #475569; --slate-light: #64748B;
            --border: #E2E8F0; --bg: #F8FAFC; --white: #FFFFFF;
            --green: #16A34A; --green-bg: #DCFCE7; --green-border: #86EFAC;
            --amber: #D97706; --amber-bg: #FEF3C7; --amber-border: #FCD34D;
            --blue: #2563EB; --blue-bg: #EFF6FF; --blue-border: #93C5FD;
            --gray-bg: #F1F5F9; --gray-border: #CBD5E1;
        }

        html { -webkit-text-size-adjust: 100%; scroll-behavior: smooth; }

        body {
            font-family: 'Sarabun', -apple-system, sans-serif;
            background: var(--bg); min-height: 100vh; color: var(--navy);
            line-height: 1.6; -webkit-font-smoothing: antialiased;
            -webkit-tap-highlight-color: transparent; font-size: 16px;
        }

        .page-main { display: block; padding-bottom: 84px; }
        .page-main.hidden { display: none; }
        .page-success { display: none; min-height: 100vh; background: var(--bg); }
        .page-success.show { display: block; }

        /* HEADER */
        .header { background: var(--navy); padding: 20px 16px 18px; border-bottom: 2px solid var(--navy-3); }
        .header-top { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
        .brand-tag { font-size: 11px; font-weight: 700; color: #94A3B8; letter-spacing: 1.5px; text-transform: uppercase; }
        .escrow-badge {
            display: inline-flex; align-items: center; gap: 5px; background: #064E3B;
            border: 1px solid #065F46; border-radius: 4px; padding: 3px 8px;
            font-size: 10px; font-weight: 700; color: #6EE7B7; letter-spacing: 0.5px;
        }
        .escrow-badge::before { content: ''; width: 6px; height: 6px; background: #34D399; border-radius: 50%; }
        .header h1 { font-size: 20px; font-weight: 800; color: var(--white); line-height: 1.3; margin-bottom: 4px; }
        .header .subtitle { font-size: 13px; color: #94A3B8; font-weight: 400; }

        /* TRUST STRIP */
        .trust-strip {
            background: #0F2744; border-bottom: 1px solid #1E3A5F;
            padding: 9px 16px; display: flex; align-items: center;
            justify-content: center; gap: 6px; flex-wrap: wrap;
        }
        .trust-item {
            display: inline-flex; align-items: center; gap: 5px;
            font-size: 11px; font-weight: 600; color: #93C5FD; white-space: nowrap;
        }
        .trust-item::before { content: '‚úì'; color: #34D399; font-weight: 800; font-size: 12px; }
        .trust-sep { color: #334155; font-size: 14px; line-height: 1; }

        /* STEP BAR */
        .step-bar {
            background: var(--white); border-bottom: 1px solid var(--border);
            padding: 11px 16px; display: flex; align-items: center; justify-content: center;
        }
        .step-item { display: flex; align-items: center; gap: 6px; }
        .step-num {
            width: 22px; height: 22px; border-radius: 50%; border: 2px solid var(--border);
            display: flex; align-items: center; justify-content: center;
            font-size: 10px; font-weight: 800; color: var(--slate-light); background: var(--bg); flex-shrink: 0;
        }
        .step-num.active { background: var(--blue); border-color: var(--blue); color: var(--white); }
        .step-num.done   { background: var(--green); border-color: var(--green); color: var(--white); font-size: 11px; }
        .step-lbl { font-size: 11px; font-weight: 600; color: var(--slate-light); }
        .step-lbl.active { color: var(--blue); }
        .step-lbl.done   { color: var(--green); }
        .step-line { width: 20px; height: 2px; background: var(--border); margin: 0 8px; flex-shrink: 0; }
        .step-line.done { background: var(--green); }

        /* NOTICE */
        .notice-bar { background: #1E3A5F; border-bottom: 1px solid #1D4ED8; padding: 10px 16px; display: flex; align-items: center; gap: 10px; }
        .notice-text { font-size: 12px; color: #BAE6FD; line-height: 1.5; font-weight: 500; }

        /* MONTH NAV */
        .month-nav {
            background: var(--white); border-bottom: 1px solid var(--border);
            padding: 12px 16px; display: flex; align-items: center;
            justify-content: space-between; gap: 12px;
            position: sticky; top: 0; z-index: 50;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        .month-arrow {
            width: 44px; height: 44px; background: var(--bg);
            border: 1.5px solid var(--border); border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; font-size: 20px; color: var(--navy-2); font-weight: 700;
            -webkit-tap-highlight-color: transparent; flex-shrink: 0; transition: all 0.15s;
            user-select: none;
        }
        .month-arrow:active { background: var(--border); transform: scale(0.95); }
        .month-arrow.disabled { opacity: 0.25; cursor: not-allowed; pointer-events: none; }
        .month-center { flex: 1; text-align: center; }
        .month-label { font-size: 17px; font-weight: 800; color: var(--navy); display: block; line-height: 1.2; }
        .month-sublabel { font-size: 11px; color: var(--slate-light); font-weight: 500; margin-top: 2px; display: block; }
        .month-dots { display: flex; justify-content: center; gap: 6px; margin-top: 7px; }
        .month-dot { width: 7px; height: 7px; border-radius: 50%; background: var(--border); transition: background 0.2s, transform 0.2s; }
        .month-dot.active { background: var(--blue); transform: scale(1.2); }

        /* LEGEND */
        .legend-inline { padding: 8px 16px 12px; display: flex; gap: 14px; flex-wrap: wrap; }
        .legend-item { display: flex; align-items: center; gap: 5px; font-size: 11px; color: var(--slate); font-weight: 600; }
        .legend-dot { width: 10px; height: 10px; border-radius: 2px; border: 1px solid; flex-shrink: 0; }
        .legend-dot.available { background: var(--green-bg); border-color: var(--green-border); }
        .legend-dot.limited   { background: var(--amber-bg); border-color: var(--amber-border); }
        .legend-dot.full      { background: var(--gray-bg);  border-color: var(--gray-border); }

        /* PANELS */
        .month-panel { display: none; }
        .month-panel.active { display: block; }

        /* DATE CARDS */
        .date-list { padding: 0 12px 16px; display: flex; flex-direction: column; gap: 10px; }
        .date-card { background: var(--white); border: 1.5px solid var(--border); border-radius: 10px; overflow: hidden; }
        .date-card.has-available { border-color: var(--green-border); box-shadow: 0 0 0 1px var(--green-border); }
        .date-card-header {
            padding: 12px 14px; display: flex; align-items: center;
            justify-content: space-between; border-bottom: 1px solid var(--border); background: var(--bg);
        }
        .date-card.has-available .date-card-header { background: #F0FDF4; border-bottom-color: var(--green-border); }
        .date-info { display: flex; align-items: center; gap: 10px; }
        .date-num { font-size: 28px; font-weight: 800; color: var(--navy); line-height: 1; }
        .date-detail { display: flex; flex-direction: column; }
        .date-weekday { font-size: 12px; color: var(--slate-light); font-weight: 500; }
        .date-month-name { font-size: 13px; font-weight: 600; color: var(--navy-2); }
        .avail-badge { display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: 700; white-space: nowrap; }
        .avail-badge.has-open    { background: var(--green-bg); color: var(--green); border: 1px solid var(--green-border); }
        .avail-badge.limited-only{ background: var(--amber-bg); color: var(--amber); border: 1px solid var(--amber-border); }
        .avail-badge.all-full    { background: var(--gray-bg);  color: #64748B;      border: 1px solid var(--gray-border); }
        .avail-badge::before { content: ''; width: 5px; height: 5px; border-radius: 50%; background: currentColor; }

        /* SLOTS */
        .slot-grid { padding: 10px 14px 12px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .slot-btn {
            min-height: 64px; padding: 10px 8px; border-radius: 8px; border: 1.5px solid transparent;
            display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 3px;
            cursor: pointer; transition: all 0.15s; -webkit-tap-highlight-color: transparent;
            font-family: 'Sarabun', sans-serif; text-align: center; user-select: none;
        }
        .slot-btn .slot-period { font-size: 10px; font-weight: 600; letter-spacing: 0.5px; text-transform: uppercase; opacity: 0.8; }
        .slot-btn .slot-time   { font-size: 12px; font-weight: 700; line-height: 1.2; }
        .slot-btn .slot-tag    { font-size: 9px; font-weight: 700; padding: 1px 6px; border-radius: 10px; margin-top: 2px; }

        .slot-btn.available { background: var(--green-bg); border-color: var(--green-border); color: #14532D; }
        .slot-btn.available .slot-tag { background: #BBF7D0; color: #15803D; }
        .slot-btn.available:active { background: #BBF7D0; border-color: #22C55E; transform: scale(0.97); }

        .slot-btn.limited { background: var(--amber-bg); border-color: var(--amber-border); color: #78350F; }
        .slot-btn.limited .slot-tag { background: #FDE68A; color: #92400E; }
        .slot-btn.limited:active { background: #FDE68A; border-color: #EAB308; transform: scale(0.97); }

        .slot-btn.full { background: var(--gray-bg); border-color: var(--gray-border); color: #94A3B8; cursor: not-allowed; }
        .slot-btn.full .slot-tag { background: var(--border); color: #94A3B8; }

        .slot-btn.selected {
            border-color: var(--blue) !important; background: var(--blue-bg) !important;
            color: #1D4ED8 !important; box-shadow: 0 0 0 3px rgba(37,99,235,0.2) !important;
        }
        .slot-btn.selected .slot-tag { background: #BFDBFE !important; color: #1D4ED8 !important; }

        /* STICKY */
        .sticky-bar {
            position: fixed; bottom: 0; left: 0; right: 0; background: var(--white);
            border-top: 1px solid var(--border); padding: 12px 16px;
            padding-bottom: calc(12px + env(safe-area-inset-bottom));
            z-index: 100; box-shadow: 0 -4px 12px rgba(0,0,0,0.08);
        }
        .sticky-bar-inner { max-width: 600px; margin: 0 auto; display: flex; align-items: center; gap: 12px; }
        .sticky-selection { flex: 1; min-width: 0; }
        .sticky-selection-label { font-size: 10px; color: var(--slate-light); font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
        .sticky-selection-value { font-size: 13px; font-weight: 700; color: var(--navy); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .sticky-selection-value.empty { color: var(--slate-light); font-weight: 400; font-size: 12px; }
        .sticky-cta {
            padding: 13px 20px; background: var(--blue); border: none; border-radius: 8px;
            color: var(--white); font-family: 'Sarabun', sans-serif; font-size: 14px; font-weight: 700;
            cursor: pointer; white-space: nowrap; -webkit-tap-highlight-color: transparent; flex-shrink: 0;
        }
        .sticky-cta:disabled { background: var(--slate-light); cursor: not-allowed; opacity: 0.6; }
        .sticky-cta:active:not(:disabled) { background: #1D4ED8; }

        /* PAYMENT */
        .payment-section { margin: 0 12px 16px; background: var(--amber-bg); border: 1.5px solid var(--amber-border); border-radius: 10px; padding: 14px; }
        .payment-section h3 { font-size: 13px; font-weight: 700; color: #78350F; margin-bottom: 6px; }
        .payment-section p  { font-size: 12px; color: #92400E; line-height: 1.6; }

        /* FOOTER */
        .footer { background: var(--navy); padding: 16px; text-align: center; }
        .footer .brand   { font-size: 13px; font-weight: 700; color: #CBD5E1; letter-spacing: 1px; }
        .footer .tagline { font-size: 11px; color: #64748B; margin-top: 4px; }

        /* MODAL */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.65); z-index: 200; align-items: flex-end; justify-content: center; }
        .modal.show { display: flex; }
        .modal-sheet {
            background: var(--white); border-radius: 16px 16px 0 0; width: 100%;
            max-width: 600px; max-height: 96vh; overflow-y: auto;
            -webkit-overflow-scrolling: touch; padding-bottom: env(safe-area-inset-bottom);
        }
        @media (min-width: 640px) {
            .modal { align-items: center; padding: 16px; }
            .modal-sheet { border-radius: 12px; max-height: 92vh; }
            .sheet-handle { display: none; }
        }
        .sheet-handle { width: 40px; height: 4px; background: var(--border); border-radius: 2px; margin: 10px auto; }
        .modal-header { background: var(--navy); padding: 14px 16px 16px; }
        .modal-header h2 { font-size: 15px; font-weight: 700; color: var(--white); margin-bottom: 10px; }
        .booking-chips { display: flex; gap: 8px; flex-wrap: wrap; }
        .booking-chip { display: inline-flex; align-items: center; gap: 5px; background: var(--navy-3); border: 1px solid #475569; border-radius: 6px; padding: 5px 10px; font-size: 12px; font-weight: 600; color: var(--white); }
        .booking-chip span { opacity: 0.7; font-weight: 400; }
        .modal-body { padding: 16px; }
        .form-group { margin-bottom: 14px; }
        .form-label { display: block; font-size: 13px; font-weight: 700; color: var(--navy); margin-bottom: 6px; }
        .form-label .req { color: #DC2626; margin-left: 2px; }
        .form-input { width: 100%; padding: 12px 14px; border: 1.5px solid var(--border); border-radius: 8px; font-family: 'Sarabun', sans-serif; font-size: 16px; color: var(--navy); background: var(--white); -webkit-appearance: none; transition: border-color 0.15s, box-shadow 0.15s; }
        .form-input:focus { outline: none; border-color: var(--blue); box-shadow: 0 0 0 3px rgba(37,99,235,0.12); }
        .form-input::placeholder { color: #94A3B8; }
        .form-input.valid { border-color: var(--green); }
        .form-input.error { border-color: #DC2626; }
        .form-hint.error-msg { font-size: 11px; color: #DC2626; margin-top: 4px; display: none; }
        .form-hint.error-msg.show { display: block; }
        .privacy-bar { background: #F0FDF4; border: 1px solid var(--green-border); border-radius: 8px; padding: 10px 12px; font-size: 12px; color: #166534; line-height: 1.5; margin-bottom: 16px; display: flex; align-items: flex-start; gap: 8px; }
        .privacy-bar .icon { font-size: 14px; flex-shrink: 0; margin-top: 1px; }
        .submit-btn { width: 100%; padding: 14px; background: var(--blue); border: none; border-radius: 8px; color: var(--white); font-family: 'Sarabun', sans-serif; font-size: 15px; font-weight: 700; cursor: pointer; -webkit-tap-highlight-color: transparent; transition: background 0.15s; }
        .submit-btn:active:not(:disabled) { background: #1D4ED8; }
        .submit-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .cancel-link { display: block; text-align: center; margin-top: 12px; font-size: 13px; color: var(--slate-light); cursor: pointer; padding: 6px; }

        /* LINE BUTTON */
        .line-btn {
            width: 100%; padding: 15px; background: #06C755; border: none; border-radius: 10px;
            color: var(--white); font-family: 'Sarabun', sans-serif; font-size: 16px; font-weight: 800;
            cursor: pointer; -webkit-tap-highlight-color: transparent; margin-bottom: 10px;
            display: flex; align-items: center; justify-content: center; gap: 10px;
            box-shadow: 0 4px 12px rgba(6,199,85,0.35); transition: all 0.15s;
            letter-spacing: 0.3px;
        }
        .line-btn:active { background: #05A847; transform: scale(0.98); box-shadow: 0 2px 6px rgba(6,199,85,0.25); }
        .line-btn-icon { width: 24px; height: 24px; background: var(--white); border-radius: 6px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .line-btn-icon svg { width: 16px; height: 16px; }

        /* SUCCESS enhancements */
        .escrow-confirmed {
            background: #F0FDF4; border: 1.5px solid var(--green-border);
            border-radius: 10px; padding: 12px 14px; margin-bottom: 16px;
            display: flex; align-items: center; gap: 10px;
        }
        .escrow-confirmed-icon { font-size: 22px; flex-shrink: 0; }
        .escrow-confirmed-text { font-size: 12px; color: #166534; line-height: 1.5; }
        .escrow-confirmed-text strong { display: block; font-size: 13px; margin-bottom: 2px; }
        .success-header { text-align: center; margin-bottom: 24px; }
        .success-check { width: 72px; height: 72px; background: var(--green-bg); border: 3px solid var(--green-border); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 14px; font-size: 32px; color: var(--green); }
        .success-title { font-size: 22px; font-weight: 800; color: var(--navy); margin-bottom: 4px; }
        .success-sub   { font-size: 13px; color: var(--slate-light); }
        .ref-hero { background: var(--navy); border-radius: 12px; padding: 20px; text-align: center; margin-bottom: 16px; }
        .ref-label  { font-size: 11px; font-weight: 700; color: #64748B; letter-spacing: 1.5px; text-transform: uppercase; margin-bottom: 8px; }
        .ref-number { font-family: 'Courier New', monospace; font-size: 26px; font-weight: 900; color: #60A5FA; letter-spacing: 2px; word-break: break-all; line-height: 1.3; }
        .ref-hint   { font-size: 11px; color: #475569; margin-top: 8px; }
        .next-step-card { background: #EFF6FF; border: 2px solid #BFDBFE; border-radius: 12px; padding: 16px; margin-bottom: 16px; }
        .next-step-title { font-size: 13px; font-weight: 700; color: #1D4ED8; margin-bottom: 4px; }
        .next-step-desc  { font-size: 12px; color: #3B82F6; line-height: 1.5; margin-bottom: 14px; }
        .copy-btn { width: 100%; padding: 13px; background: var(--blue); border: none; border-radius: 8px; color: var(--white); font-family: 'Sarabun', sans-serif; font-size: 14px; font-weight: 700; cursor: pointer; -webkit-tap-highlight-color: transparent; margin-bottom: 8px; transition: background 0.15s; display: flex; align-items: center; justify-content: center; gap: 6px; }
        .copy-btn:active { background: #1D4ED8; }
        .copy-btn.copied { background: var(--green); }
        .msg-toggle-btn { width: 100%; padding: 10px; background: none; border: 1px solid var(--border); border-radius: 8px; color: var(--slate); font-family: 'Sarabun', sans-serif; font-size: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px; }
        .msg-box-wrap { display: none; margin-top: 8px; }
        .msg-box-wrap.open { display: block; }
        .msg-box { background: var(--bg); border: 1px solid var(--border); border-radius: 8px; padding: 12px; font-size: 11px; color: var(--navy); line-height: 1.7; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New', monospace; max-height: 180px; overflow-y: auto; }
        .summary-card { background: var(--white); border: 1px solid var(--border); border-radius: 12px; padding: 14px; margin-bottom: 16px; }
        .summary-title { font-size: 12px; font-weight: 700; color: var(--slate); letter-spacing: 0.5px; text-transform: uppercase; margin-bottom: 10px; }
        .summary-row { display: flex; gap: 10px; padding: 7px 0; border-bottom: 1px solid var(--border); font-size: 13px; }
        .summary-row:last-child { border-bottom: none; }
        .summary-key { color: var(--slate-light); font-weight: 500; min-width: 72px; flex-shrink: 0; }
        .summary-val { color: var(--navy); font-weight: 600; word-break: break-word; }
        .action-row { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 24px; }
        .action-btn { padding: 12px; border: 1.5px solid var(--border); border-radius: 8px; background: var(--white); font-family: 'Sarabun', sans-serif; font-size: 13px; font-weight: 700; color: var(--navy-2); cursor: pointer; text-align: center; }
        .action-btn:active { background: var(--bg); }
        .success-footer { text-align: center; padding: 16px 0; border-top: 1px solid var(--border); }
        .success-footer .brand   { font-size: 12px; font-weight: 700; color: var(--navy-2); letter-spacing: 1px; }
        .success-footer .tagline { font-size: 11px; color: var(--slate-light); margin-top: 2px; }

        @media (min-width: 640px) {
            .date-list { padding: 0 20px 20px; }
            .legend-inline { padding: 8px 20px 14px; }
            .payment-section { margin: 0 20px 20px; }
            .slot-btn { min-height: 70px; }
        }
        @media (min-width: 1024px) {
            .header { padding: 28px 32px 24px; }
            .date-list { padding: 0 32px 24px; }
            .legend-inline { padding: 8px 32px 16px; }
            .payment-section { margin: 0 32px 24px; }
            .date-num { font-size: 32px; }
            .slot-btn { min-height: 76px; }
        }
    </style>
</head>
<body>

<div class="page-main" id="pageMain">

    <div class="header">
        <div class="header-top">
            <span class="brand-tag">K2PS Marketplace</span>
            <span class="escrow-badge">Escrow ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</span>
        </div>
        <h1>‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1>
        <p class="subtitle">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∞‡∏î‡∏ß‡∏Å</p>
    </div>

    <!-- TRUST STRIP -->
    <div class="trust-strip">
        <span class="trust-item">‡∏£‡∏∞‡∏ö‡∏ö Escrow ‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡∏£‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô</span>
        <span class="trust-sep">¬∑</span>
        <span class="trust-item">‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span>
        <span class="trust-sep">¬∑</span>
        <span class="trust-item">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
    </div>

    <!-- STEP BAR -->
    <div class="step-bar" id="stepBar">
        <div class="step-item">
            <div class="step-num active" id="s1">1</div>
            <span class="step-lbl active" id="sl1">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏ö</span>
        </div>
        <div class="step-line" id="line1"></div>
        <div class="step-item">
            <div class="step-num" id="s2">2</div>
            <span class="step-lbl" id="sl2">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
        </div>
        <div class="step-line" id="line2"></div>
        <div class="step-item">
            <div class="step-num" id="s3">3</div>
            <span class="step-lbl" id="sl3">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô LINE</span>
        </div>
    </div>

    <div class="notice-bar">
        <span style="font-size:16px;flex-shrink:0">üí∞</span>
        <span class="notice-text">‡∏ú‡∏π‡πâ‡∏ã‡∏∑‡πâ‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß ¬∑ ‡πÄ‡∏á‡∏¥‡∏ô‡∏î‡∏π‡πÅ‡∏•‡πÇ‡∏î‡∏¢ Escrow ¬∑ ‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span>
    </div>

    <!-- MONTH NAV -->
    <div class="month-nav">
        <button class="month-arrow disabled" id="prevBtn" onclick="switchMonth(-1)">‚Äπ</button>
        <div class="month-center">
            <span class="month-label" id="monthLabel">‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569</span>
            <span class="month-sublabel" id="monthMeta">6 ‡∏£‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏á</span>
            <div class="month-dots">
                <div class="month-dot active" id="dot0"></div>
                <div class="month-dot" id="dot1"></div>
            </div>
        </div>
        <button class="month-arrow" id="nextBtn" onclick="switchMonth(1)">‚Ä∫</button>
    </div>

    <div class="legend-inline">
        <div class="legend-item"><div class="legend-dot available"></div>‡∏ß‡πà‡∏≤‡∏á</div>
        <div class="legend-item"><div class="legend-dot limited"></div>‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ô‡πâ‡∏≠‡∏¢</div>
        <div class="legend-item"><div class="legend-dot full"></div>‡πÄ‡∏ï‡πá‡∏°</div>
    </div>

    <!-- PANEL 0: ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå -->
    <div class="month-panel active" id="panel-0">
        <div class="date-list" id="febList">
            <!-- filled by JS -->
        </div>
    </div>

    <!-- PANEL 1: ‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏° -->
    <div class="month-panel" id="panel-1">
        <div class="date-list" id="marchList">
            <!-- filled by JS -->
        </div>
    </div>

    <div class="payment-section">
        <h3>üîí ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</h3>
        <p>‡πÄ‡∏á‡∏¥‡∏ô‡∏ñ‡∏π‡∏Å‡∏î‡∏π‡πÅ‡∏•‡πÉ‡∏ô Escrow ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ¬∑ ‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ¬∑ ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏´‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å</p>
    </div>

    <div class="footer">
        <div class="brand">K2PS MARKETPLACE</div>
        <div class="tagline">‡∏£‡∏∞‡∏ö‡∏ö Escrow ‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏î‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</div>
            <div class="tagline" style="margin-top:4px;font-size:10px;color:#64748B;">¬© 2026 K2PS MARKETPLACE. All rights reserved.</div>
    </div>
</div>

<!-- STICKY -->
<div class="sticky-bar" id="stickyBar">
    <div class="sticky-bar-inner">
        <div class="sticky-selection">
            <div class="sticky-selection-label">‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</div>
            <div class="sticky-selection-value empty" id="stickyText">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏ö</div>
        </div>
        <button class="sticky-cta" id="stickyCta" disabled onclick="openModal()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</button>
    </div>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
    <div class="modal-sheet">
        <div class="sheet-handle"></div>
        <div class="modal-header">
            <h2>‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
            <div class="booking-chips">
                <div class="booking-chip"><span>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</span> <span id="chipDate">‚Äî</span></div>
                <div class="booking-chip"><span>‡πÄ‡∏ß‡∏•‡∏≤</span>  <span id="chipTime">‚Äî</span></div>
            </div>
        </div>
        <div class="modal-body">
            <form id="bookingForm" onsubmit="submitForm(event)" novalidate>
                <div class="form-group">
                    <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• <span class="req">*</span></label>
                    <input type="text" class="form-input" id="name" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" autocomplete="name" required>
                </div>
                <div class="form-group">
                    <label class="form-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå <span class="req">*</span></label>
                    <input type="tel" class="form-input" id="phone" placeholder="08x-xxx-xxxx" autocomplete="tel" inputmode="tel" maxlength="12" required>
                    <div class="form-hint error-msg" id="phoneErr">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</div>
                </div>
                <div class="form-group">
                    <label class="form-label">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ <span class="req">*</span></label>
                    <input type="text" class="form-input" id="addr" placeholder="‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ‡∏ñ‡∏ô‡∏ô ‡∏ï‡∏≥‡∏ö‡∏• ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠" autocomplete="street-address" required>
                </div>
                <div class="form-group">
                    <label class="form-label">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                    <input type="text" class="form-input" id="note" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÇ‡∏õ‡∏£‡∏î‡πÇ‡∏ó‡∏£‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ 30 ‡∏ô‡∏≤‡∏ó‡∏µ">
                </div>
                <div class="privacy-bar">
                    <span class="icon">üîí</span>
                    <span>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</span>
                </div>
                <button type="submit" class="submit-btn" id="submitBtn" disabled>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</button>
                <span class="cancel-link" onclick="closeModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å / ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà</span>
            </form>
        </div>
    </div>
</div>

<!-- SUCCESS PAGE -->
<div class="page-success" id="pageSuccess">
    <div class="success-page">
        <div class="success-header">
            <div class="success-check">‚úì</div>
            <div class="success-title">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>
            <div class="success-sub">‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 30 ‡∏ô‡∏≤‡∏ó‡∏µ</div>
        </div>

        <!-- Escrow confirmed trust card -->
        <div class="escrow-confirmed">
            <div class="escrow-confirmed-icon">üîí</div>
            <div class="escrow-confirmed-text">
                <strong>‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</strong>
                ‡∏£‡∏∞‡∏ö‡∏ö Escrow ‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏Å‡∏ö‡∏≤‡∏ó ¬∑ ‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
            </div>
        </div>

        <div class="ref-hero">
            <div class="ref-label">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏î‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>
            <div class="ref-number" id="refNum">‚Äî</div>
            <div class="ref-hint">‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ‡πÑ‡∏ß‡πâ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</div>
        </div>

        <!-- LINE AUTO-SEND (Primary CTA) -->
        <div class="next-step-card">
            <div class="next-step-title">üìã ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Äî ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</div>
            <div class="next-step-desc">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á LINE ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏£‡∏π‡∏õ ‡∏Å‡∏î‡∏™‡πà‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</div>

            <!-- LINE Deep Link Button -->
            <a href="https://line.me/R/ti/p/~@449icqdu" target="_blank" class="line-btn">
                <span class="line-btn-icon">
                    <svg viewBox="0 0 24 24" fill="#06C755"><path d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346 0 .627.285.627.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63.346 0 .628.285.628.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.281.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.070 9.436-6.975C23.176 14.393 24 12.458 24 10.314"/></svg>
                </span>
                ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ó‡∏≤‡∏á LINE
            </a>

            <!-- Fallback copy -->
            <button class="copy-btn" id="copyBtn" onclick="copyMessage()"><span id="copyText">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏™‡∏≥‡∏£‡∏≠‡∏á)</span></button>
            <button class="msg-toggle-btn" onclick="toggleMsg(this)"><span>‚ñº ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á</span></button>
            <div class="msg-box-wrap" id="msgBoxWrap"><div class="msg-box" id="msgBox"></div></div>
        </div>

        <div class="summary-card">
            <div class="summary-title">‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</div>
            <div class="summary-row"><span class="summary-key">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</span><span class="summary-val" id="sumDate">‚Äî</span></div>
            <div class="summary-row"><span class="summary-key">‡πÄ‡∏ß‡∏•‡∏≤</span><span class="summary-val" id="sumTime">‚Äî</span></div>
            <div class="summary-row"><span class="summary-key">‡∏ä‡∏∑‡πà‡∏≠</span><span class="summary-val" id="sumName">‚Äî</span></div>
            <div class="summary-row"><span class="summary-key">‡πÄ‡∏ö‡∏≠‡∏£‡πå</span><span class="summary-val" id="sumPhone">‚Äî</span></div>
            <div class="summary-row"><span class="summary-key">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</span><span class="summary-val" id="sumAddr">‚Äî</span></div>
            <div class="summary-row" id="sumNoteRow" style="display:none"><span class="summary-key">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</span><span class="summary-val" id="sumNote">‚Äî</span></div>
        </div>
        <div class="action-row">
            <button class="action-btn" onclick="bookNew()">üîÑ ‡∏à‡∏≠‡∏á‡∏£‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà</button>
            <a href="https://line.me/R/ti/p/~@449icqdu" target="_blank" class="action-btn">‡πÄ‡∏û‡∏¥‡πà‡∏° LINE</a>
        </div>
        <div class="success-footer">
            <div class="brand">K2PS MARKETPLACE</div>
            <div class="tagline">‡∏£‡∏∞‡∏ö‡∏ö Escrow ‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏î‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</div>
            <div class="tagline" style="margin-top:4px;font-size:10px;color:#64748B;">¬© 2026 K2PS MARKETPLACE. All rights reserved.</div>
        </div>
    </div>
</div>

<script>
const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxRfoSC-qB9LoLb9y2IdMwInSXZ07f_fbCCzUPv5R8QJDsdVn_2p3KDY5mRbIF3XA8-Kw/exec';

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚öôÔ∏è LINE OA CONFIG ‚Äî ‡πÉ‡∏™‡πà LINE OA ID ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
// ‡πÄ‡∏ä‡πà‡∏ô '@k2ps' ‡∏´‡∏£‡∏∑‡∏≠ '@abc1234d'
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const LINE_OA_ID = '@YOUR_LINE_OA_ID';

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚öôÔ∏è DATA CONFIG ‚Äî ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569 (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≠‡∏ö)
// 'a' = ‡∏ß‡πà‡∏≤‡∏á, 'l' = ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ô‡πâ‡∏≠‡∏¢, 'f' = ‡πÄ‡∏ï‡πá‡∏°
const FEB_DATA = {
    22: { am:'f', pm:'f', weekday:'‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå' },
    23: { am:'f', pm:'f', weekday:'‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå' },
    24: { am:'f', pm:'f', weekday:'‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£' },
    25: { am:'f', pm:'f', weekday:'‡∏û‡∏∏‡∏ò' },
    26: { am:'l', pm:'l', weekday:'‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ' },
    27: { am:'a', pm:'l', weekday:'‡∏®‡∏∏‡∏Å‡∏£‡πå' },
    28: { am:'l', pm:'l', weekday:'‡πÄ‡∏™‡∏≤‡∏£‡πå' }
};

// ‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏° 2569 (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1-31) ‚Äî ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡πÅ‡∏Å‡πâ‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á
const MARCH_DATA = {
    1:  { am:'a', pm:'a', weekday:'‡πÄ‡∏™‡∏≤‡∏£‡πå' },
    2:  { am:'a', pm:'l', weekday:'‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå' },
    3:  { am:'l', pm:'a', weekday:'‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå' },
    4:  { am:'a', pm:'a', weekday:'‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£' },
    5:  { am:'a', pm:'l', weekday:'‡∏û‡∏∏‡∏ò' },
    6:  { am:'l', pm:'l', weekday:'‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ' },
    7:  { am:'a', pm:'f', weekday:'‡∏®‡∏∏‡∏Å‡∏£‡πå' },
    8:  { am:'l', pm:'a', weekday:'‡πÄ‡∏™‡∏≤‡∏£‡πå' },
    9:  { am:'a', pm:'a', weekday:'‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå' },
    10: { am:'a', pm:'l', weekday:'‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå' },
    11: { am:'l', pm:'a', weekday:'‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£' },
    12: { am:'a', pm:'a', weekday:'‡∏û‡∏∏‡∏ò' },
    13: { am:'f', pm:'a', weekday:'‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ' },
    14: { am:'a', pm:'l', weekday:'‡∏®‡∏∏‡∏Å‡∏£‡πå' },
    15: { am:'l', pm:'l', weekday:'‡πÄ‡∏™‡∏≤‡∏£‡πå' },
    16: { am:'a', pm:'a', weekday:'‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå' },
    17: { am:'l', pm:'a', weekday:'‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå' },
    18: { am:'a', pm:'l', weekday:'‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£' },
    19: { am:'a', pm:'a', weekday:'‡∏û‡∏∏‡∏ò' },
    20: { am:'l', pm:'f', weekday:'‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ' },
    21: { am:'a', pm:'a', weekday:'‡∏®‡∏∏‡∏Å‡∏£‡πå' },
    22: { am:'l', pm:'l', weekday:'‡πÄ‡∏™‡∏≤‡∏£‡πå' },
    23: { am:'a', pm:'l', weekday:'‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå' },
    24: { am:'a', pm:'a', weekday:'‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå' },
    25: { am:'l', pm:'a', weekday:'‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£' },
    26: { am:'a', pm:'l', weekday:'‡∏û‡∏∏‡∏ò' },
    27: { am:'f', pm:'a', weekday:'‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ' },
    28: { am:'a', pm:'l', weekday:'‡∏®‡∏∏‡∏Å‡∏£‡πå' },
    29: { am:'l', pm:'a', weekday:'‡πÄ‡∏™‡∏≤‡∏£‡πå' },
    30: { am:'a', pm:'a', weekday:'‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå' },
    31: { am:'l', pm:'l', weekday:'‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå' }
};

const MONTH_CONFIG = [
    { label:'‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569', monthName:'‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå 2569', monthNum:'02', data: FEB_DATA,   containerId:'febList' },
    { label:'‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏° 2569',     monthName:'‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏° 2569',     monthNum:'03', data: MARCH_DATA, containerId:'marchList' }
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

let currentMonth = 0;
let selBtn = null, selDay = null, selPeriod = null, selWeekday = null, selMonthName = null, selMonthNum = null;
let currentMessage = '';

// ‚îÄ‚îÄ‚îÄ BUILD CARDS ‚îÄ‚îÄ‚îÄ
function buildCards(cfg) {
    const list = document.getElementById(cfg.containerId);
    if (list.children.length > 0) return;
    const S = { a:'available', l:'limited', f:'full' };
    const L = { a:'‡∏ß‡πà‡∏≤‡∏á', l:'‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ô‡πâ‡∏≠‡∏¢', f:'‡πÄ‡∏ï‡πá‡∏°' };
    let html = '';
    Object.keys(cfg.data).sort((a,b)=>+a-+b).forEach(d => {
        const info = cfg.data[d];
        const hasAvail = info.am==='a' || info.pm==='a';
        const allFull  = info.am==='f' && info.pm==='f';
        const cardCls  = hasAvail ? 'date-card has-available' : 'date-card';
        const bdgCls   = hasAvail ? 'avail-badge has-open' : (allFull ? 'avail-badge all-full' : 'avail-badge limited-only');
        const bdgTxt   = hasAvail ? '‡∏°‡∏µ‡∏£‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏á' : (allFull ? '‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô' : '‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ô‡πâ‡∏≠‡∏¢');
        const slot = (period, s) => s === 'f'
            ? `<button class="slot-btn full" disabled><span class="slot-period">${period==='am'?'‡∏£‡∏≠‡∏ö‡πÄ‡∏ä‡πâ‡∏≤':'‡∏£‡∏≠‡∏ö‡∏ö‡πà‡∏≤‡∏¢'}</span><span class="slot-time">${period==='am'?'09:00‚Äì12:00':'13:00‚Äì17:00'}</span><span class="slot-tag">‡πÄ‡∏ï‡πá‡∏°</span></button>`
            : `<button class="slot-btn ${S[s]}" onclick="selectSlot(this,${d},'${period}','${info.weekday}','${cfg.monthName}','${cfg.monthNum}')"><span class="slot-period">${period==='am'?'‡∏£‡∏≠‡∏ö‡πÄ‡∏ä‡πâ‡∏≤':'‡∏£‡∏≠‡∏ö‡∏ö‡πà‡∏≤‡∏¢'}</span><span class="slot-time">${period==='am'?'09:00‚Äì12:00':'13:00‚Äì17:00'}</span><span class="slot-tag">${L[s]}</span></button>`;
        html += `<div class="${cardCls}"><div class="date-card-header"><div class="date-info"><div class="date-num">${d}</div><div class="date-detail"><span class="date-weekday">‡∏ß‡∏±‡∏ô${info.weekday}</span><span class="date-month-name">${cfg.monthName}</span></div></div><span class="${bdgCls}">${bdgTxt}</span></div><div class="slot-grid">${slot('am',info.am)}${slot('pm',info.pm)}</div></div>`;
    });
    list.innerHTML = html;
}

// ‚îÄ‚îÄ‚îÄ STEP INDICATOR ‚îÄ‚îÄ‚îÄ
function setStep(n) {
    for (let i=1;i<=3;i++) {
        const num=document.getElementById('s'+i), lbl=document.getElementById('sl'+i);
        if (!num) continue;
        if (i<n)       { num.className='step-num done'; num.textContent='‚úì'; lbl.className='step-lbl done'; }
        else if (i===n){ num.className='step-num active'; num.textContent=i; lbl.className='step-lbl active'; }
        else           { num.className='step-num'; num.textContent=i; lbl.className='step-lbl'; }
    }
    for (let i=1;i<=2;i++) {
        const line=document.getElementById('line'+i);
        if (line) line.className = i<n ? 'step-line done' : 'step-line';
    }
}

// ‚îÄ‚îÄ‚îÄ LINE AUTO-SEND ‚îÄ‚îÄ‚îÄ
function openLINE() {
    if (!currentMessage) return;
    const oaId = LINE_OA_ID.replace('@','');
    const text  = encodeURIComponent(currentMessage);
    // Deep link: ‡πÄ‡∏õ‡∏¥‡∏î chat ‡∏Å‡∏±‡∏ö OA ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
    const deepLink = 'https://line.me/R/oaMessage/' + oaId + '/?text=' + text;
    window.open(deepLink, '_blank');
}
function switchMonth(dir) {
    const next = currentMonth + dir;
    if (next < 0 || next > 1) return;
    currentMonth = next;
    document.querySelectorAll('.month-panel').forEach((p,i) => p.classList.toggle('active', i===currentMonth));
    document.querySelectorAll('.month-dot').forEach((d,i)   => d.classList.toggle('active', i===currentMonth));
    document.getElementById('monthLabel').textContent = MONTH_CONFIG[currentMonth].label;
    document.getElementById('monthMeta').textContent  = currentMonth===0 ? '7 ‡∏£‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏á' : '31 ‡∏ß‡∏±‡∏ô';
    document.getElementById('prevBtn').classList.toggle('disabled', currentMonth===0);
    document.getElementById('nextBtn').classList.toggle('disabled', currentMonth===1);
    buildCards(MONTH_CONFIG[currentMonth]);
    resetSelection();
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

// ‚îÄ‚îÄ‚îÄ SLOT SELECT ‚îÄ‚îÄ‚îÄ
function selectSlot(btn, day, period, weekday, monthName, monthNum) {
    if (selBtn) selBtn.classList.remove('selected');
    btn.classList.add('selected');
    selBtn=btn; selDay=day; selPeriod=period; selWeekday=weekday; selMonthName=monthName; selMonthNum=monthNum;
    const shortMonth = monthNum==='02' ? '‡∏Å.‡∏û.' : '‡∏°‡∏µ.‡∏Ñ.';
    const periodTh   = period==='am' ? '‡∏£‡∏≠‡∏ö‡πÄ‡∏ä‡πâ‡∏≤ 09:00‚Äì12:00' : '‡∏£‡∏≠‡∏ö‡∏ö‡πà‡∏≤‡∏¢ 13:00‚Äì17:00';
    document.getElementById('stickyText').textContent = day+' '+shortMonth+' ¬∑ '+periodTh;
    document.getElementById('stickyText').classList.remove('empty');
    document.getElementById('stickyCta').disabled = false;
    setStep(2);
}

function resetSelection() {
    if (selBtn) { selBtn.classList.remove('selected'); selBtn=null; }
    selDay=selPeriod=selWeekday=selMonthName=selMonthNum=null;
    document.getElementById('stickyText').textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≠‡∏ö';
    document.getElementById('stickyText').classList.add('empty');
    document.getElementById('stickyCta').disabled = true;
}

// ‚îÄ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ‚îÄ
function openModal() {
    if (!selDay) return;
    document.getElementById('chipDate').textContent = selDay+' '+selMonthName+' (‡∏ß‡∏±‡∏ô'+selWeekday+')';
    document.getElementById('chipTime').textContent = selPeriod==='am' ? '‡∏£‡∏≠‡∏ö‡πÄ‡∏ä‡πâ‡∏≤: 09:00‚Äì12:00 ‡∏ô.' : '‡∏£‡∏≠‡∏ö‡∏ö‡πà‡∏≤‡∏¢: 13:00‚Äì17:00 ‡∏ô.';
    document.getElementById('modal').classList.add('show');
    document.body.style.overflow = 'hidden';
    setTimeout(()=>document.getElementById('name').focus(), 300);
}
function closeModal() {
    document.getElementById('modal').classList.remove('show');
    document.body.style.overflow = '';
}

// ‚îÄ‚îÄ‚îÄ PHONE ‚îÄ‚îÄ‚îÄ
document.getElementById('phone').addEventListener('input', function() {
    let v = this.value.replace(/\D/g,'').slice(0,10);
    if (v.length>6) v=v.slice(0,3)+'-'+v.slice(3,6)+'-'+v.slice(6);
    else if (v.length>3) v=v.slice(0,3)+'-'+v.slice(3);
    this.value=v; validatePhone(); checkFormReady();
});
function validatePhone() {
    const raw=document.getElementById('phone').value.replace(/\D/g,'');
    const ok=/^0[0-9]{8,9}$/.test(raw);
    const el=document.getElementById('phone'), err=document.getElementById('phoneErr');
    if (!raw.length) { el.classList.remove('valid','error'); err.classList.remove('show'); }
    else if (ok)     { el.classList.add('valid'); el.classList.remove('error'); err.classList.remove('show'); }
    else             { el.classList.add('error'); el.classList.remove('valid'); err.classList.add('show'); }
    return ok;
}
['name','addr'].forEach(id=>document.getElementById(id).addEventListener('input', checkFormReady));
function checkFormReady() {
    const name=document.getElementById('name').value.trim();
    const phone=document.getElementById('phone').value.replace(/\D/g,'');
    const addr=document.getElementById('addr').value.trim();
    document.getElementById('submitBtn').disabled = !(name && /^0[0-9]{8,9}$/.test(phone) && addr);
}

// ‚îÄ‚îÄ‚îÄ SUBMIT ‚îÄ‚îÄ‚îÄ
async function submitForm(e) {
    e.preventDefault();
    if (!validatePhone()) return;
    const name=document.getElementById('name').value.trim();
    const phone=document.getElementById('phone').value.trim();
    const addr=document.getElementById('addr').value.trim();
    const note=document.getElementById('note').value.trim();
    const btn=document.getElementById('submitBtn');
    btn.disabled=true; btn.textContent='‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
    const now=new Date();
    const refNum='KPS-LOG-'+String(now.getMonth()+1).padStart(2,'0')+String(now.getDate()).padStart(2,'0')+String(Math.floor(Math.random()*1000)).padStart(3,'0');
    const dateText=selDay+' '+selMonthName+' (‡∏ß‡∏±‡∏ô'+selWeekday+')';
    const timeText=selPeriod==='am' ? '‡∏£‡∏≠‡∏ö‡πÄ‡∏ä‡πâ‡∏≤: 09:00‚Äì12:00 ‡∏ô.' : '‡∏£‡∏≠‡∏ö‡∏ö‡πà‡∏≤‡∏¢: 13:00‚Äì17:00 ‡∏ô.';
    const ts=now.toLocaleString('th-TH',{timeZone:'Asia/Bangkok'});
    try { await fetch(APPS_SCRIPT_URL+'?'+new URLSearchParams({ref:refNum,name,phone,address:addr,note,date:dateText,slot:timeText,ts}).toString(),{method:'GET',redirect:'follow'}); } catch(e){}
    currentMessage='‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß\n\nüìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: '+dateText+'\n‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤: '+timeText+'\nüë§ ‡∏ä‡∏∑‡πà‡∏≠: '+name+'\nüìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå: '+phone+'\nüìç ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: '+addr+'\n'+(note?'üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: '+note+'\n':'')+' üîñ ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏î: '+refNum+'\n\n‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 30 ‡∏ô‡∏≤‡∏ó‡∏µ';
    document.getElementById('refNum').textContent=refNum;
    document.getElementById('msgBox').textContent=currentMessage;
    document.getElementById('sumDate').textContent=dateText;
    document.getElementById('sumTime').textContent=timeText;
    document.getElementById('sumName').textContent=name;
    document.getElementById('sumPhone').textContent=phone;
    document.getElementById('sumAddr').textContent=addr;
    if (note) { document.getElementById('sumNote').textContent=note; document.getElementById('sumNoteRow').style.display='flex'; }
    closeModal();
    document.getElementById('pageMain').classList.add('hidden');
    document.getElementById('stickyBar').style.display='none';
    document.getElementById('pageSuccess').classList.add('show');
    document.getElementById('stepBar').style.display='none';
    setStep(3);
    window.scrollTo(0,0);
}

// ‚îÄ‚îÄ‚îÄ COPY ‚îÄ‚îÄ‚îÄ
function copyMessage() {
    const btn=document.getElementById('copyBtn'), lbl=document.getElementById('copyText');
    const done=()=>{ btn.classList.add('copied'); lbl.textContent='‚úì ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß'; setTimeout(()=>{ btn.classList.remove('copied'); lbl.textContent='üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡πà‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô LINE'; },2500); };
    if (navigator.clipboard&&navigator.clipboard.writeText) navigator.clipboard.writeText(currentMessage).then(done);
    else { const ta=document.createElement('textarea'); ta.value=currentMessage; ta.style.cssText='position:fixed;opacity:0'; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta); done(); }
}
function toggleMsg(btn) {
    const wrap=document.getElementById('msgBoxWrap'), open=wrap.classList.toggle('open');
    btn.querySelector('span').textContent=open?'‚ñ≤ ‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°':'‚ñº ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å';
}
function bookNew() {
    document.getElementById('pageSuccess').classList.remove('show');
    document.getElementById('pageMain').classList.remove('hidden');
    document.getElementById('stickyBar').style.display='';
    document.getElementById('stepBar').style.display='';
    resetSelection();
    setStep(1);
    document.getElementById('bookingForm').reset();
    document.getElementById('submitBtn').disabled=true;
    document.querySelectorAll('.form-input').forEach(el=>el.classList.remove('valid','error'));
    document.getElementById('phoneErr').classList.remove('show');
    document.getElementById('sumNoteRow').style.display='none';
    window.scrollTo(0,0);
}
document.getElementById('modal').addEventListener('click',e=>{ if(e.target===document.getElementById('modal')) closeModal(); });

// ‚îÄ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ
buildCards(MONTH_CONFIG[0]);
setStep(1);
</script>

</body>
</html>
